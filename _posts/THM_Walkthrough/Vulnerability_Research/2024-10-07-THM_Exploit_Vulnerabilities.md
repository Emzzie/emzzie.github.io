---
title: TryHackMe - Exploit Vulnerabilities
description: A walkthrough of TryHackMe's room " Exploit Vulnerabilities".
categories: [Walkthrough THM, Vulnerability Research Module]
tags: [Basics]
pin: false
---

Lab access: [https://tryhackme.com/r/room/exploitingavulnerabilityv2](https://tryhackme.com/r/room/exploitingavulnerabilityv2)

## Task 1: Introduction
In this room, we'll explore different methods to identify vulnerabilities and enhance our research skills to understand how these weaknesses can be exploited.

You'll also discover some valuable publicly available resources to improve your vulnerability research and exploitation abilities. Finally, you'll have the opportunity to put this knowledge into practice with a hands-on challenge at the end.

## Automated Vs. Manual Vulnerability Research
There are many services available in cyber security providing vulnerability scanning, varying from commercial and pricy to ope-source and free. The automated scanners are convenient when it comes to quickly scan an application for flaws. 

Automated scans are easy to repeat and the scanners are quick and can test numerous applications efficiently. They cover a wide range of vulnerabilities that can be hard to search for manually. There are open-source solutions as well, making them available to the public, but these might only provide basic services. The scanners also produce a lot of traffic and logging increasing the likelihood of detection. 

Manually searching for vulnerabilities is often chosen by penetration testers when testing individual application or programs. This allows the penetration tester to have more control over the scan.

There are a few vulnerabilities worth mentioning:

| Vulnerability           | Description                                                                                                                      |
|-------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| Security Misconfigurations | Security misconfigurations involve vulnerabilities that are due to developer oversight. <br> For example, exposing server information in messages between the application <br> and an attacker. |
| Broken Access Control   | This vulnerability occurs when an attacker is able to access parts of an application that <br> they are not supposed to be able to otherwise. |
| Insecure Deserialization | This is the insecure processing of data that is sent across an application. An attacker <br> may be able to pass malicious code to the application, where it will then be executed. |
| Injection               | An Injection vulnerability exists when an attacker is able to input malicious data <br> into an application. This is due to the failure of not ensuring <br> (known as sanitising) input is not harmful. |

---

**Q: You are working close to a deadline for your penetration test and need to scan a web application quickly. Would you use an automated scanner? (Yay/Nay)**
<details><summary>Answer</summary>
Yay. It is of course a question of priorities, is it staying covert or getting the scan done? In this case we are more keen to having the scan done than remaining covert.
</details>

---

**Q: You are testing a web application and find that you are able to input and retrieve data in a database.  What vulnerability is this?**
<details><summary>Answer</summary>
Injection
</details>

---

**Q: You manage to impersonate another user. What vulnerability is this?**
<details><summary>Answer</summary>
Broken Access Control
</details>

## Task 3: Finding Manual Exploits
This task will briefly cover a few places to find exploits.

### Rapid7
Like Exploit-DB and NVD, Rapid7 is a vulnerability research database. It does, however, also act as an exploit database. It allows yout o filter on the type of vulnerability.
Furthermore, it contains instructions on how to exploit the application using Metasploit.

### GitHub
GitHub is a web-based platform that facilitates version control and collaboration for software development projects. It has become a place for Security Researchers to store and share PoC's, turning it into an exploit database in this context. 

### Searchsploit
Searchsploit is available on most pentesting OS distributions, such as Kali Linux. It is essentially an offline copy of Exploit-DB, making it useful if you don't have any internet access!

---

**Q: What website would you use as a security researcher if you wanted to upload a Proof of Concept?**
<details><summary>Answer</summary>
GitHub
</details>

---

**Q: You are performing a penetration test at a site with no internet connection. What tool could you use to find exploits to use?**
<details><summary>Answer</summary>
Searchsploit
</details>

## Task 4: Example of Manual Exploitation
When you have found an exploit you will most likely have an executable file that will perform the exploit. You might, however, have to set a few options or update IP addresses etc for it to work. 

---

**Q: What type of vulnerability was used in this attack?**
<details><summary>Answer</summary>
Remote Code Execution
</details>

## Task 5: Practical: Manual Exploitation
Deploy the machine attached to this task and wait a minimum of five minutes for it to be fully set up. After five minutes, visit the web server running on the machine by navigating to http://MACHINE_IP in the browser of the device connected to the THM network (your own or the AttackBox).

---

**Q: Find out the version of the application that is running. What are the name and version number of the application?**

We see only one name with a version number after it, so that should be the one!
![alt text](/assets/images/exploit_vulnerabilities_q1.png)

---

**Q: Now use the resources and skills from this module to find an exploit that will allow you to gain remote access to the vulnerable machine.**

So let's have a look at exploit db first.

![alt text](/assets/images/exploit_vulnerabilities_q2.png)

We find that there is one allowing remote code execution (second last), we always like RCE... So let's give that one a try!

-- No answer needed --

**Q: Use this exploit against the vulnerable machine. What is the value of the flag located in a web directory?**

I downloaded the exploit and renamed it. You should see something like the following when running:

![alt text](/assets/images/exploit_vulnerabilities_q3.png)

with `cat flag.txt` you will get the flag!

